# ==========================================
# Basic settings
# ==========================================

# Change the prefix key from Ctrl-b to Ctrl-t.
# (Easier to press one-handed and less likely to conflict with other shortcuts.)
set -g prefix C-t
unbind C-b
bind C-t send-prefix

# Enable mouse support.
set -g mouse on

# Remove the Escape key delay.
set -s escape-time 0

# Start indices at 1 (0 is on the far right of the keyboard and harder to press).
set -g base-index 1
setw -g pane-base-index 1

# Shortcut to reload the config file (Prefix + r).
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# Enable 256-color mode.
set -g default-terminal "screen-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# ==========================================
# Key bindings (usability)
# ==========================================

# Split panes in an intuitive way.
bind | split-window -h -c "#{pane_current_path}" # Split left/right (inherit current path).
bind - split-window -v -c "#{pane_current_path}" # Split top/bottom (inherit current path).

# ==========================================
# 3. Emacs-like keybindings
# ==========================================

# --- Split panes (match Emacs C-x 2 / C-x 3) ---
# Prefix + 3 splits left/right (Emacs C-x 3).
bind 3 split-window -h -c "#{pane_current_path}"
# Prefix + 2 splits top/bottom (Emacs C-x 2).
bind 2 split-window -v -c "#{pane_current_path}"

# --- Pane navigation (C-p, C-n, C-b, C-f) ---
# Use Emacs cursor keys instead of arrow keys for pane movement.
bind -r C-p select-pane -U  # Up (previous line).
bind -r C-n select-pane -D  # Down (next line).
bind -r C-b select-pane -L  # Left (backward char).
bind -r C-f select-pane -R  # Right (forward char).

# --- Window switching ---
# Prefix + o moves to the next pane (like Emacs C-x o).
bind o select-pane -t :.+

# --- Resize panes ---
# Resize with Shift + P, N, B, F.
bind -r P resize-pane -U 5
bind -r N resize-pane -D 5
bind -r B resize-pane -L 5
bind -r F resize-pane -R 5


# ==========================================
# macOS-specific settings (clipboard integration)
# ==========================================

# Use Emacs keys for copy mode.
setw -g mode-keys emacs

# macOS clipboard integration (Emacs mode).
bind-key -T copy-mode-emacs C-w send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-emacs M-w send-keys -X copy-pipe-and-cancel "pbcopy"
# Copy with mouse drag.
bind-key -T copy-mode-emacs MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# ==========================================
# Appearance (status bar)
# ==========================================

# Place the status bar at the top.
set -g status-position top

# Status bar colors.
set -g status-fg white
set -g status-bg black

# Left display (session name).
set -g status-left-length 40
set -g status-left "#[fg=green]Session: #S #[default]"

# Right display (date/time).
set -g status-right "#[fg=cyan][%Y-%m-%d(%a) %H:%M]"

# Highlight the active window.
setw -g window-status-current-style fg=white,bg=blue,bright
